{"ast":null,"code":"import _regeneratorRuntime from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import ProductBuyContract from\"./contracts/ProductBuy.json\";import TestToken from\"./contracts/TestToken.json\";import Navbar from\"./Navbar.js\";import getWeb3 from\"./getWeb3\";import\"./App.css\";var BigNumber=require('bignumber.js');var ListProducts=/*#__PURE__*/function(_Component){_inherits(ListProducts,_Component);function ListProducts(){var _getPrototypeOf2;var _this;_classCallCheck(this,ListProducts);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(ListProducts)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={products:null,web3:null,account:\"\",contract:null,token:null,tokenName:null,approved:false,product:null,statuses:null,taxTolerance:null,priceWithTax:\"0\",decimals:null};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var web3,account,networkId,deployedNetworkProduct,instance,tokenAddress,deployedNetworkToken,token,product,products,tokenName,tokenSymbol,taxTolerance,decimals;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getWeb3();case 3:web3=_context.sent;_context.next=6;return window.ethereum.request({method:'eth_accounts'});case 6:account=_context.sent;console.log(account[0]);// Get the contract instance.\n_context.next=10;return web3.eth.net.getId();case 10:networkId=_context.sent;deployedNetworkProduct=ProductBuyContract.networks[networkId];instance=new web3.eth.Contract(ProductBuyContract.abi,deployedNetworkProduct&&deployedNetworkProduct.address);_context.next=15;return instance.methods.token().call();case 15:tokenAddress=_context.sent;deployedNetworkToken=TestToken.networks[networkId];token=new web3.eth.Contract(TestToken.abi,deployedNetworkToken&&deployedNetworkToken.address);product=deployedNetworkProduct.address;_context.next=21;return instance.methods.viewProducts().call();case 21:products=_context.sent;_context.next=24;return token.methods.name().call();case 24:tokenName=_context.sent;_context.next=27;return token.methods.symbol().call();case 27:tokenSymbol=_context.sent;_context.next=30;return instance.methods.taxTolerance().call();case 30:taxTolerance=_context.sent;_context.next=33;return token.methods.decimals().call();case 33:decimals=_context.sent;// Set web3, accounts, and contract to the state, and then proceed with an\n// example of interacting with the contract's methods.\n_this.setState({web3:web3,account:account[0],contract:instance,products:products,token:token,tokenName:tokenName,tokenSymbol:tokenSymbol,product:product,taxTolerance:taxTolerance,decimals:decimals});_context.next=41;break;case 37:_context.prev=37;_context.t0=_context[\"catch\"](0);// Catch any errors for any of the above operations.\nalert(\"Failed to load web3, accounts, or contract. Check console for details.\");console.error(_context.t0);case 41:case\"end\":return _context.stop();}}},_callee,null,[[0,37]]);}));_this.handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var name,link,price,bnPrice;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();name=document.getElementsByName(\"field1\")[0].value;link=document.getElementsByName(\"field2\")[0].value;price=document.getElementsByName(\"field3\")[0].value;bnPrice=new BigNumber(price).times(Math.pow(10,_this.state.decimals));console.log(bnPrice);_context2.next=8;return _this.state.contract.methods.listProduct(name,link,bnPrice.toString()).send({from:_this.state.account});case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.handlePrice=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var priceWithTax;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(_this.state.taxTolerance!==\"0\"){priceWithTax=document.getElementsByName(\"field3\")[0].value*(100-_this.state.taxTolerance)/100;_this.setState({priceWithTax:priceWithTax});}else{_this.setState({priceWithTax:document.getElementsByName(\"field3\")[0].value});}case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref3.apply(this,arguments);};}();return _this;}_createClass(ListProducts,[{key:\"render\",value:function render(){return React.createElement(\"div\",{className:\"App\"},React.createElement(Navbar,{account:this.state.account}),React.createElement(\"h1\",null,\"List a Product\"),React.createElement(\"div\",{class:\"form-style-6\"},React.createElement(\"h1\",null,\"Product Details\"),React.createElement(\"form\",null,React.createElement(\"input\",{type:\"text\",name:\"field1\",placeholder:\"Product Name\"}),React.createElement(\"input\",{type:\"text\",name:\"field2\",placeholder:\"Product Link\"}),React.createElement(\"input\",{onChange:this.handlePrice,type:\"text\",name:\"field3\",placeholder:\"Product Price \"+\"in \"+this.state.tokenName}),React.createElement(\"p\",null,\"You will receive \",this.state.priceWithTax,\" \",this.state.tokenSymbol,\" (\",this.state.taxTolerance+\"% tax on \"+this.state.tokenName+\" transfer\",\")\"),React.createElement(\"input\",{type:\"submit\",value:\"List\",onClick:this.handleSubmit}))));}}]);return ListProducts;}(Component);export default ListProducts;","map":{"version":3,"sources":["/Users/israeladelaja/Desktop/Product DApp/client/src/ListProducts.js"],"names":["React","Component","ProductBuyContract","TestToken","Navbar","getWeb3","BigNumber","require","ListProducts","state","products","web3","account","contract","token","tokenName","approved","product","statuses","taxTolerance","priceWithTax","decimals","componentDidMount","window","ethereum","request","method","console","log","eth","net","getId","networkId","deployedNetworkProduct","networks","instance","Contract","abi","address","methods","call","tokenAddress","deployedNetworkToken","viewProducts","name","symbol","tokenSymbol","setState","alert","error","handleSubmit","event","preventDefault","document","getElementsByName","value","link","price","bnPrice","times","listProduct","toString","send","from","handlePrice"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport ProductBuyContract from \"./contracts/ProductBuy.json\";\nimport TestToken from \"./contracts/TestToken.json\";\nimport Navbar from \"./Navbar.js\";\nimport getWeb3 from \"./getWeb3\";\nimport \"./App.css\";\n\nconst BigNumber = require('bignumber.js');\n\nclass ListProducts extends Component {\n\n    state = {products: null, web3: null, account: \"\", contract: null, token: null, tokenName: null, approved: false, product: null, statuses: null, taxTolerance: null, priceWithTax: \"0\", decimals: null }\n\n    componentDidMount = async () => {\n        try {\n          // Get network provider and web3 instance.\n            const web3 = await getWeb3();\n\n            const account = await window.ethereum.request({ method: 'eth_accounts' });\n            console.log(account[0])\n\n            // Get the contract instance.\n            const networkId = await web3.eth.net.getId();\n            const deployedNetworkProduct = ProductBuyContract.networks[networkId];\n            const instance = new web3.eth.Contract(\n                ProductBuyContract.abi,\n                deployedNetworkProduct && deployedNetworkProduct.address,\n            );\n\n            let tokenAddress = await instance.methods.token().call();\n\n            const deployedNetworkToken = TestToken.networks[networkId];\n            const token = new web3.eth.Contract(\n                TestToken.abi,\n                deployedNetworkToken && deployedNetworkToken.address,\n            );\n\n            let product = deployedNetworkProduct.address;\n\n            let products = await instance.methods.viewProducts().call();\n\n            let tokenName = await token.methods.name().call();\n\n            let tokenSymbol = await token.methods.symbol().call();\n\n            let taxTolerance = await instance.methods.taxTolerance().call();\n\n            let decimals = await token.methods.decimals().call();\n\n\n          // Set web3, accounts, and contract to the state, and then proceed with an\n          // example of interacting with the contract's methods.\n          this.setState({web3, account: account[0], contract: instance, products, token, tokenName, tokenSymbol, product, taxTolerance, decimals });\n    \n        } catch (error) {\n          // Catch any errors for any of the above operations.\n          alert(\n            `Failed to load web3, accounts, or contract. Check console for details.`,\n          );\n          console.error(error);\n        }\n    };    \n\n    handleSubmit = async (event) => {\n        event.preventDefault();\n\n        let name = document.getElementsByName(\"field1\")[0].value;\n        let link = document.getElementsByName(\"field2\")[0].value;\n        let price = document.getElementsByName(\"field3\")[0].value;\n\n        let bnPrice = new BigNumber(price).times(10**this.state.decimals);\n        console.log(bnPrice)\n\n        await this.state.contract.methods.listProduct(name, link, bnPrice.toString()).send({from: this.state.account});\n    }\n\n    handlePrice = async (event) => {\n        if (this.state.taxTolerance !== \"0\") {\n            let priceWithTax = document.getElementsByName(\"field3\")[0].value * (100 - this.state.taxTolerance) / 100;\n            this.setState({priceWithTax})\n        } else {\n            this.setState({priceWithTax: document.getElementsByName(\"field3\")[0].value})\n        }\n\n    }\n\n\n  render() {\n    return (\n        <div className=\"App\">\n            <Navbar account={this.state.account}/>\n            <h1>List a Product</h1>\n            <div class=\"form-style-6\">\n                <h1>Product Details</h1>\n                <form>\n                    <input type=\"text\" name=\"field1\" placeholder=\"Product Name\" />\n                    <input type=\"text\" name=\"field2\" placeholder=\"Product Link\" />\n                    <input onChange={this.handlePrice} type=\"text\" name=\"field3\" placeholder={\"Product Price \" + \"in \" + this.state.tokenName}></input>\n                    <p>You will receive {this.state.priceWithTax} {this.state.tokenSymbol} ({this.state.taxTolerance + \"% tax on \" + this.state.tokenName + \" transfer\"})</p>\n                    <input type=\"submit\" value=\"List\" onClick={this.handleSubmit} />\n\n                </form>\n            </div>\n        </div>\n    );\n  }\n}\n\nexport default ListProducts;\n"]},"metadata":{},"sourceType":"module"}