{"ast":null,"code":"'use strict';\n\nconst _require = require('multiformats/cid'),\n      CID = _require.CID;\n\nconst configure = require('../lib/configure');\n\nconst _require2 = require('ipfs-core-utils/src/pins/normalise-input'),\n      normaliseInput = _require2.normaliseInput;\n\nconst toUrlSearchParams = require('../lib/to-url-search-params');\n/**\n * @typedef {import('../types').HTTPClientExtraOptions} HTTPClientExtraOptions\n * @typedef {import('ipfs-core-types/src/pin').API<HTTPClientExtraOptions>} PinAPI\n */\n\n\nmodule.exports = configure(api => {\n  /**\n   * @type {PinAPI[\"addAll\"]}\n   */\n  async function* addAll(source, options = {}) {\n    for await (const _ref of normaliseInput(source)) {\n      const path = _ref.path;\n      const recursive = _ref.recursive;\n      const metadata = _ref.metadata;\n      const res = await api.post('pin/add', {\n        signal: options.signal,\n        searchParams: toUrlSearchParams({ ...options,\n          arg: path,\n          recursive,\n          metadata: metadata ? JSON.stringify(metadata) : undefined,\n          stream: true\n        }),\n        headers: options.headers\n      });\n\n      for await (const pin of res.ndjson()) {\n        if (pin.Pins) {\n          // non-streaming response\n          for (const cid of pin.Pins) {\n            yield CID.parse(cid);\n          }\n\n          continue;\n        }\n\n        yield CID.parse(pin);\n      }\n    }\n  }\n\n  return addAll;\n});","map":null,"metadata":{},"sourceType":"script"}