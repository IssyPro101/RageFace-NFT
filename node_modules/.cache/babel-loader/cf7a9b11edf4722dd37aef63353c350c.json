{"ast":null,"code":"import _regeneratorRuntime from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/israeladelaja/Desktop/Product DApp/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import ProductBuyContract from\"./contracts/ProductBuy.json\";import TestToken from\"./contracts/TestToken.json\";import getWeb3 from\"./getWeb3\";import Navbar from\"./Navbar.js\";import\"./App.css\";var MyProducts=/*#__PURE__*/function(_Component){_inherits(MyProducts,_Component);function MyProducts(){var _getPrototypeOf2;var _this;_classCallCheck(this,MyProducts);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(MyProducts)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={products:null,web3:null,account:null,contract:null,token:null,tokenName:null,approved:false,product:null,decimals:null};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var web3,account,networkId,deployedNetworkProduct,instance,tokenAddress,deployedNetworkToken,token,product,products,tokenName,tokenSymbol,decimals;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getWeb3();case 3:web3=_context.sent;_context.next=6;return window.ethereum.request({method:'eth_accounts'});case 6:account=_context.sent;console.log(account[0]);// Get the contract instance.\n_context.next=10;return web3.eth.net.getId();case 10:networkId=_context.sent;deployedNetworkProduct=ProductBuyContract.networks[networkId];instance=new web3.eth.Contract(ProductBuyContract.abi,deployedNetworkProduct&&deployedNetworkProduct.address);_context.next=15;return instance.methods.token().call();case 15:tokenAddress=_context.sent;deployedNetworkToken=TestToken.networks[networkId];token=new web3.eth.Contract(TestToken.abi,deployedNetworkToken&&tokenAddress);product=deployedNetworkProduct.address;_context.next=21;return instance.methods.getBoughtProducts().call({from:_this.state.account});case 21:products=_context.sent;console.log(products);_context.next=25;return token.methods.name().call();case 25:tokenName=_context.sent;_context.next=28;return token.methods.symbol().call();case 28:tokenSymbol=_context.sent;_context.next=31;return token.methods.decimals().call();case 31:decimals=_context.sent;// Set web3, accounts, and contract to the state, and then proceed with an\n// example of interacting with the contract's methods.\n_this.setState({web3:web3,account:account[0],contract:instance,products:products,token:token,tokenName:tokenName,tokenSymbol:tokenSymbol,product:product,decimals:decimals});_context.next=39;break;case 35:_context.prev=35;_context.t0=_context[\"catch\"](0);// Catch any errors for any of the above operations.\nalert(\"Failed to load web3, accounts, or contract. Check console for details.\");console.error(_context.t0);case 39:case\"end\":return _context.stop();}}},_callee,null,[[0,35]]);}));return _this;}_createClass(MyProducts,[{key:\"render\",value:function render(){var _this2=this;var content;if(!this.state.web3){return React.createElement(\"div\",null,\"Loading Web3, accounts, and contracts...\");}else if(this.state.products.length===0){content=React.createElement(\"h3\",{id:\"no-products\"},\"You haven't bought any products.\");}else{content=this.state.products.map(function(product,key){return React.createElement(\"div\",{className:\"product\"},React.createElement(\"h2\",null,product.productName),React.createElement(\"p\",null,\"Id: \",product.productId),React.createElement(\"p\",null,\"Product Link: \",product.productLink),React.createElement(\"p\",null,\"Price: \",product.productPrice/Math.pow(10,_this2.state.decimals),\" \",_this2.state.tokenSymbol));});}return React.createElement(\"div\",{className:\"App\"},React.createElement(Navbar,{account:this.state.account}),React.createElement(\"h1\",null,\"My Products\"),React.createElement(\"div\",{id:\"products\"},content));}}]);return MyProducts;}(Component);export default MyProducts;","map":{"version":3,"sources":["/Users/israeladelaja/Desktop/Product DApp/client/src/MyProducts.js"],"names":["React","Component","ProductBuyContract","TestToken","getWeb3","Navbar","MyProducts","state","products","web3","account","contract","token","tokenName","approved","product","decimals","componentDidMount","window","ethereum","request","method","console","log","eth","net","getId","networkId","deployedNetworkProduct","networks","instance","Contract","abi","address","methods","call","tokenAddress","deployedNetworkToken","getBoughtProducts","from","name","symbol","tokenSymbol","setState","alert","error","content","length","map","key","productName","productId","productLink","productPrice"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport ProductBuyContract from \"./contracts/ProductBuy.json\";\nimport TestToken from \"./contracts/TestToken.json\";\nimport getWeb3 from \"./getWeb3\";\nimport Navbar from \"./Navbar.js\";\n\nimport \"./App.css\";\n\nclass MyProducts extends Component {\n  state = { products: null, web3: null, account: null, contract: null, token: null, tokenName: null, approved: false, product: null, decimals: null };\n\n  componentDidMount = async () => {\n    try {\n      // Get network provider and web3 instance.\n      const web3 = await getWeb3();\n\n      // Use web3 to get the user's accounts.\n      const account = await window.ethereum.request({ method: 'eth_accounts' });\n      console.log(account[0])\n\n      // Get the contract instance.\n      const networkId = await web3.eth.net.getId();\n      const deployedNetworkProduct = ProductBuyContract.networks[networkId];\n      const instance = new web3.eth.Contract(\n        ProductBuyContract.abi,\n        deployedNetworkProduct && deployedNetworkProduct.address,\n      );\n\n      let tokenAddress = await instance.methods.token().call();\n\n      const deployedNetworkToken = TestToken.networks[networkId];\n      const token = new web3.eth.Contract(\n        TestToken.abi,\n        deployedNetworkToken && tokenAddress,\n      );\n\n      let product = deployedNetworkProduct.address;\n\n      let products = await instance.methods.getBoughtProducts().call({from: this.state.account});\n      console.log(products)\n\n      let tokenName = await token.methods.name().call();\n\n      let tokenSymbol = await token.methods.symbol().call();\n\n      let decimals = await token.methods.decimals().call();\n\n      // Set web3, accounts, and contract to the state, and then proceed with an\n      // example of interacting with the contract's methods.\n      this.setState({ web3, account: account[0], contract: instance, products, token,tokenName, tokenSymbol, product, decimals});\n\n    } catch (error) {\n      // Catch any errors for any of the above operations.\n      alert(\n        `Failed to load web3, accounts, or contract. Check console for details.`,\n      );\n      console.error(error);\n    }\n  };\n  \n  render() {\n    let content;\n    if (!this.state.web3) {\n      return <div>Loading Web3, accounts, and contracts...</div>;\n    } else if (this.state.products.length === 0) {\n      content = <h3 id=\"no-products\">You haven't bought any products.</h3>\n    } else {\n      content = this.state.products.map((product, key) => {\n        return ( \n            <div className=\"product\">\n              <h2>{product.productName}</h2>\n              <p>Id: {product.productId}</p>\n              <p>Product Link: {product.productLink}</p>\n              <p>Price: {product.productPrice/10**this.state.decimals} {this.state.tokenSymbol}</p>\n            </div>\n        )    \n\n      })\n    }\n    return (\n      <div className=\"App\">\n        <Navbar account={this.state.account}/>\n        <h1>My Products</h1>\n        <div id=\"products\">\n          {content}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default MyProducts;\n"]},"metadata":{},"sourceType":"module"}